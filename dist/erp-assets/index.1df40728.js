var W=Object.defineProperty,$=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var O=(u,e,t)=>e in u?W(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t,w=(u,e)=>{for(var t in e||(e={}))J.call(e,t)&&O(u,t,e[t]);if(z)for(var t of z(e))Q.call(e,t)&&O(u,t,e[t]);return u},M=(u,e)=>$(u,G(e));import{r as d,e as X,l as y,a0 as Y,al as _,aj as Z,b as r,aF as U,j as D,bK as j,aH as H,F as ee,c as N,t as re,B as b,aP as te,aV as ue,s as se}from"./vendor.475cee01.js";/* empty css               *//* empty css               *//* empty css              */import{OrderCreateSchema1 as ne,OrderCreateSchema2 as ae,OrderCreateSchema3 as oe}from"./schema.035d054d.js";import{o as ce,F as q,P as ie}from"./index.b2d919ca.js";import{H as V}from"./style.4b618b1b.js";import{u as le,s as me}from"./index.9a618fcf.js";import{e as de}from"./index.4f759f94.js";import"./index.7f218578.js";import"./index.ab849bc2.js";/* empty css               */import"./shopStore.936c9d2c.js";import"./index.cc99a160.js";/* empty css              */import"./index.599b9453.js";/* empty css               */import"./index.36bc3114.js";/* empty css              */import"./clipboard.a809cca0.js";/* empty css               */import"./entrepot.95f11770.js";import"./schema.524eafb7.js";/* empty css               */function pe(u,e,t){var a=this,i=d.exports.useRef(null),l=d.exports.useRef(0),o=d.exports.useRef(null),A=d.exports.useRef([]),p=d.exports.useRef(),h=d.exports.useRef(),C=d.exports.useRef(u),F=d.exports.useRef(!0);C.current=u;var g=typeof window!="undefined",v=!e&&e!==0&&g;if(typeof u!="function")throw new TypeError("Expected a function");e=+e||0;var I=!!(t=t||{}).leading,P=!("trailing"in t)||!!t.trailing,x="maxWait"in t,s="debounceOnServer"in t&&!!t.debounceOnServer,n=x?Math.max(+t.maxWait||0,e):null;d.exports.useEffect(function(){return F.current=!0,function(){F.current=!1}},[]);var f=d.exports.useMemo(function(){var E=function(c){var m=A.current,L=p.current;return A.current=p.current=null,l.current=c,h.current=C.current.apply(L,m)},B=function(c,m){v&&cancelAnimationFrame(o.current),o.current=v?requestAnimationFrame(c):setTimeout(c,m)},k=function(c){if(!F.current)return!1;var m=c-i.current;return!i.current||m>=e||m<0||x&&c-l.current>=n},T=function(c){return o.current=null,P&&A.current?E(c):(A.current=p.current=null,h.current)},R=function c(){var m=Date.now();if(k(m))return T(m);if(F.current){var L=e-(m-i.current),K=x?Math.min(L,n-(m-l.current)):L;B(c,K)}},S=function(){if(g||s){var c=Date.now(),m=k(c);if(A.current=[].slice.call(arguments),p.current=a,i.current=c,m){if(!o.current&&F.current)return l.current=i.current,B(R,e),I?E(i.current):h.current;if(x)return B(R,e),E(i.current)}return o.current||B(R,e),h.current}};return S.cancel=function(){o.current&&(v?cancelAnimationFrame(o.current):clearTimeout(o.current)),l.current=0,A.current=i.current=p.current=o.current=null},S.isPending=function(){return!!o.current},S.flush=function(){return o.current?T(Date.now()):h.current},S},[I,x,e,n,P,v,g,s]);return f}const Fe="_container_xm0e8_1",he="_wrapper_xm0e8_7",fe="_form_xm0e8_11";var Ee={container:Fe,wrapper:he,form:fe,"form-extra":"_form-extra_xm0e8_16"};const Be={"en-US":{"menu.form":"Form","menu.form.step":"Step Form","stepForm.title":"Create a channel form","stepForm.next":"Next","stepForm.prev":"Prev","stepForm.title.basicInfo":"Basic Information","stepForm.desc.basicInfo":"Create event channel","stepForm.title.channel":"Channel Information","stepForm.desc.channel":"Enter detailed channel content","stepForm.title.created":"Complete creation","stepForm.desc.created":"Created successfully","stepForm.basicInfo.name":"Event name","stepForm.basicInfo.name.required":"Please enter the event name","stepForm.basicInfo.name.placeholder":"Enter Chinese characters, letters or numbers, up to 20 characters","stepForm.basicInfo.channelType":"Channel Type","stepForm.basicInfo.channelType.required":"Please select the channel type","stepForm.basicInfo.time":"Promotion time","stepForm.basicInfo.time.required":"Please select the promotion time","stepForm.basicInfo.link":"Promotion URL","stepForm.basicInfo.link.placeholder":"Please enter the promotion page address","stepForm.basicInfo.link.tips":"Such as Android or iOS download address, intermediate redirect URL, the URL must start with http:// or https://","stepForm.channel.source":"Advertising source","stepForm.channel.source.required":"Please enter the advertising source","stepForm.channel.source.placeholder":"Referral address: sohu, sina","stepForm.channel.media":"Advertising medium","stepForm.channel.media.required":"Please enter the advertising medium","stepForm.channel.media.placeholder":"Marketing media: cpc, bannner, edm","stepForm.channel.keywords":"Key words","stepForm.channel.remind":"Push reminder","stepForm.channel.content":"Advertising content","stepForm.channel.content.required":"Please enter the advertising content","stepForm.channel.content.placeholder":"Please enter the description of the advertisement content, no more than 200 words","stepForm.created.success.title":"Created successfully","stepForm.created.success.desc":"Form created successfully","stepForm.created.success.view":"View form","stepForm.created.success.again":"Create again","stepForm.created.extra.title":"Channel form description","stepForm.created.extra.desc":"Advertiser channel promotion supports the tracking of users who place ads on third-party advertisers to download App users, such as launching App download advertisements on Toutiao channels, and tracking users who activate App by downloading on channels. ","stepForm.created.extra.detail":"Details"},"zh-CN":{"menu.form":"\u8868\u5355\u9875","menu.form.step":"\u5206\u5E03\u8868\u5355","stepForm.title":"\u521B\u5EFA\u6E20\u9053\u8868\u5355","stepForm.next":"\u4E0B\u4E00\u6B65","stepForm.prev":"\u4E0A\u4E00\u6B65","stepForm.title.basicInfo":"\u57FA\u672C\u4FE1\u606F","stepForm.desc.basicInfo":"\u521B\u5EFA\u6D3B\u52A8\u6E20\u9053","stepForm.title.channel":"\u8F93\u5165\u6E20\u9053\u4FE1\u606F","stepForm.desc.channel":"\u8F93\u5165\u8BE6\u7EC6\u7684\u6E20\u9053\u5185\u5BB9","stepForm.title.created":"\u5B8C\u6210\u521B\u5EFA","stepForm.desc.created":"\u521B\u5EFA\u6210\u529F","stepForm.basicInfo.name":"\u6D3B\u52A8\u540D\u79F0","stepForm.basicInfo.name.required":"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0","stepForm.basicInfo.name.placeholder":"\u8F93\u5165\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\uFF0C\u6700\u591A20\u5B57\u7B26","stepForm.basicInfo.channelType":"\u6E20\u9053\u7C7B\u578B","stepForm.basicInfo.channelType.required":"\u8BF7\u9009\u62E9\u6E20\u9053\u7C7B\u578B","stepForm.basicInfo.time":"\u63A8\u5E7F\u65F6\u95F4","stepForm.basicInfo.time.required":"\u8BF7\u9009\u62E9\u63A8\u5E7F\u65F6\u95F4","stepForm.basicInfo.link":"\u63A8\u5E7F\u5730\u5740","stepForm.basicInfo.link.placeholder":"\u8BF7\u8F93\u5165\u63A8\u5E7F\u9875\u9762\u5730\u5740","stepForm.basicInfo.link.tips":"\u5982 Android \u6216 iOS \u7684\u4E0B\u8F7D\u5730\u5740\u3001\u4E2D\u95F4\u8DF3\u8F6CURL\uFF0C\u7F51\u5740\u5FC5\u987B\u4EE5 http:// \u6216 https:// \u5F00\u5934","stepForm.channel.source":"\u5E7F\u544A\u6765\u6E90","stepForm.channel.source.required":"\u8BF7\u8F93\u5165\u5E7F\u544A\u6765\u6E90","stepForm.channel.source.placeholder":"\u5F15\u8350\u6765\u6E90\u5730\u5740\uFF1Asohu\u3001sina","stepForm.channel.media":"\u5E7F\u544A\u5A92\u4ECB","stepForm.channel.media.required":"\u8BF7\u8F93\u5165\u5E7F\u544A\u5A92\u4ECB","stepForm.channel.media.placeholder":"\u8425\u9500\u5A92\u4ECB\uFF1Acpc\u3001bannner\u3001edm","stepForm.channel.keywords":"\u5173\u952E\u8BCD","stepForm.channel.remind":"\u63A8\u9001\u63D0\u9192","stepForm.channel.content":"\u5E7F\u544A\u5185\u5BB9","stepForm.channel.content.required":"\u8BF7\u8F93\u5165\u5E7F\u544A\u5185\u5BB9","stepForm.channel.content.placeholder":"\u8BF7\u8F93\u5165\u5E7F\u544A\u5185\u5BB9\u4ECB\u7ECD\uFF0C\u6700\u591A\u4E0D\u8D85\u8FC7200\u5B57","stepForm.created.success.title":"\u521B\u5EFA\u6210\u529F","stepForm.created.success.desc":"\u8868\u5355\u521B\u5EFA\u6210\u529F","stepForm.created.success.view":"\u67E5\u770B\u8868\u5355","stepForm.created.success.again":"\u518D\u6B21\u521B\u5EFA","stepForm.created.extra.title":"\u6E20\u9053\u8868\u5355\u8BF4\u660E","stepForm.created.extra.desc":"\u5E7F\u544A\u5546\u6E20\u9053\u63A8\u5E7F\u652F\u6301\u8FFD\u8E2A\u5728\u7B2C\u4E09\u65B9\u5E7F\u544A\u5546\u6295\u653E\u5E7F\u544A\u4E0B\u8F7DApp\u7528\u6237\u7684\u573A\u666F\uFF0C\u4F8B\u5982\u5728\u4ECA\u65E5\u5934\u6761\u6E20\u9053\u6295\u653E\u4E0B\u8F7DApp\u5E7F\u544A\uFF0C\u8FFD\u8E2A\u901A\u8FC7\u5728\u6E20\u9053\u4E0B\u8F7D\u6FC0\u6D3BApp\u7684\u7528\u6237\u3002","stepForm.created.extra.detail":"\u67E5\u770B\u8BE6\u60C5"}};var Ae=Be,Ke=()=>{var x;const u=de(),[e,t]=X("create-order",{defaultValue:{}}),[a,i]=d.exports.useState(1),[l,o]=d.exports.useState((e.orderProductList||[{}]).map(s=>M(w({},s),{_id:y.exports.random(0,999999)}))),A=Y(),p=d.exports.useRef([]),[h]=_.useForm(),[C]=_.useForm(),F=pe(s=>{t(w(w({},e),s))},300),g=le(Ae),v=()=>{h.clearFields(),C.clearFields(),o([{_id:y.exports.random(0,999999)}]),p.current.forEach(s=>{s.clearFields()})},I=Z(async()=>{await me(()=>ce.insert(w({customStatus:!0},e))).then(s=>(v(),s)),i(a+1)},{manual:!0}),P=async()=>{var s;a===1?await h.validate():a===2?(console.log(p.current),await Promise.all((s=p.current)==null?void 0:s.map(n=>n.validate()))):a===3&&await C.validate(),i(a+1)};return r("div",{className:"bg-white p-4 syb-content-h",children:r(U,{children:D("div",{className:Ee.wrapper,children:[D(j,{current:a,lineless:!0,className:"mb-20",children:[r(j.Step,{title:g["stepForm.title.basicInfo"],description:"\u8BA2\u5355\u57FA\u7840\u4FE1\u606F"}),r(j.Step,{title:"\u8BA2\u5355\u5546\u54C1\u4FE1\u606F",description:"\u8BE6\u7EC6\u7684\u5546\u54C1sku"}),r(j.Step,{title:"\u4E70\u5BB6\u57FA\u672C\u4FE1\u606F",description:"\u6536\u4EF6\u4EBA\u4FE1\u606F\u76F8\u5173"}),r(j.Step,{title:"\u5B8C\u6210\u521B\u5EFA",description:"\u521B\u5EFA\u6210\u529F"})]}),u.loading?D("div",{className:"flex gap-10",children:[r(H,{animation:!0,className:"w-1/2",text:{width:["60%","90%"],rows:8}}),r(H,{animation:!0,className:"w-1/2",text:{width:["60%","90%"],rows:8}})]}):D(ee,{children:[r(q,{form:h,initialValues:y.exports.merge({sendWarehouse:(x=u==null?void 0:u.data)==null?void 0:x.id},e),className:N(a!==1?V:""),span:12,size:"small",formItemConfigList:ne,onValuesChange:(s,n)=>{const f=h.getFieldsValue();F(y.exports.merge(f,n))}}),r("div",{className:N(a!==2?V:""),children:r(_.Provider,{onFormValuesChange:async(s,n,f)=>{const E=await Promise.all(l.map((B,k)=>f.forms[`orderProductList[${k}]`].validate()));F({orderProductList:E})},children:D("div",{className:"flex flex-col gap-4",children:[l.map((s,n)=>{var f;return r(U,{bordered:!0,title:`SKU - ${n+1}`,hoverable:!0,extra:l.length>1&&r(re,{children:r(ie,{onOk:()=>{l.splice(n,1),F({orderProductList:e.orderProductList.filter((E,B)=>B!==n)}),o([...l])},children:r(b,{size:"mini",icon:r(te,{}),shape:"circle",status:"danger",style:{margin:"0 20px"}})})}),children:r(q,{initialValues:w({deliveryMethod:"0"},(f=e.orderProductList)==null?void 0:f[n]),id:`orderProductList[${n}]`,span:12,size:"small",formItemConfigList:ae,ref:E=>{E?p.current[n]=E:p.current.splice(n,1)},onValuesChange:(E,B)=>{F(B)}})},s._id)}),r(b,{type:"dashed",status:"success",className:"mt-4",icon:r(ue,{}),onClick:()=>{l.push({_id:y.exports.random(0,999999)}),o([...l])},children:"\u6DFB\u52A0"})]})})}),r(q,{form:C,initialValues:e,className:N(a!==3?V:""),span:12,size:"small",formItemConfigList:oe,onValuesChange:(s,n)=>{const f=C.getFieldsValue();F(y.exports.merge(f,n))}}),a===4&&r(se,{status:"success",title:g["stepForm.created.success.title"],subTitle:"\u8BA2\u5355\u521B\u5EFA\u6210\u529F",extra:[r(b,{style:{marginRight:16},onClick:()=>{i(1)},children:"\u7EE7\u7EED\u521B\u5EFA"},"reset"),r(b,{type:"primary",onClick:()=>{A.push("/client/order/alreadyPacked")},children:"\u67E5\u770B\u8BA2\u5355"},"again")]}),D("div",{className:"flex justify-center gap-4 mt-12",children:[a>1&&a<4&&r(b,{size:"large",onClick:()=>i(a-1),children:"\u4E0A\u4E00\u6B65"}),a<3&&r(b,{type:"primary",size:"large",onClick:P,children:"\u4E0B\u4E00\u6B65"}),a===3&&r(b,{type:"primary",size:"large",onClick:()=>{I.run()},loading:I.loading,children:"\u521B\u5EFA"})]})]})]})})})};export{Ke as default};
