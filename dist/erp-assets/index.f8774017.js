var M=Object.defineProperty,R=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var P=(n,s,r)=>s in n?M(n,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[s]=r,p=(n,s)=>{for(var r in s||(s={}))L.call(s,r)&&P(n,r,s[r]);if(k)for(var r of k(s))B.call(s,r)&&P(n,r,s[r]);return n},y=(n,s)=>R(n,q(s));import{r as f,be as K,aj as N,b as a,j as o,aI as F,i as h,B as E,aV as w,a1 as z,bj as H,M as O}from"./vendor.475cee01.js";/* empty css               */import{MenuTypeTag as V}from"./index.a625b698.js";import{x as G,s as U}from"./index.9a618fcf.js";import{r as u,a as W,A as $,P as J,F as Q}from"./index.b2d919ca.js";import{L as X}from"./index.3b332b51.js";import{S as v,F as Y,a as Z}from"./index.7f218578.js";import"./statusTag.1d433c1a.js";import"./index.4f759f94.js";import"./entrepot.95f11770.js";import"./index.ab849bc2.js";/* empty css               */import"./shopStore.936c9d2c.js";import"./index.cc99a160.js";/* empty css              */import"./index.599b9453.js";/* empty css               */import"./index.36bc3114.js";/* empty css              */import"./style.4b618b1b.js";import"./clipboard.a809cca0.js";/* empty css               */import"./schema.524eafb7.js";/* empty css               */import"./schema.035d054d.js";/* empty css              */function Te(){const n=["0-0","0-1","0-0-2"],[s,r]=f.exports.useState([]);f.exports.useState(n);const[e,b]=f.exports.useState(null),[c]=K(),S=G(),[D,x]=f.exports.useState(null),{data:l,loading:j,run:g}=N(()=>u.get({pageNum:1,pageSize:30}).then(i=>(e||b(i.data.data.list[0]),i.data.data.list))),T=N(()=>(e==null?void 0:e.id)?u.info(e.id).then(i=>{var m,d;r(((d=(m=i.data)==null?void 0:m.data)==null?void 0:d.menuIds)||[])}):null,{refreshDeps:[e==null?void 0:e.id]}),I=N(i=>U(()=>u.remove(i),"\u5220\u9664").then(()=>{(e==null?void 0:e.id)===i&&b(l==null?void 0:l[0]),g()}),{manual:!0});return a(W,{formRef:c,createRequest:u.create,updateRequest:i=>u.update(p(p({},D),i)),refreshRequest:g,children:a($.Consumer,{children:({showType:i,setShowType:m,createAction:d,updateAction:C})=>o("div",{className:"bg-white p-4 pb-6",children:[o(F.Row,{gutter:[20,0],children:[o(F.Col,{span:6,className:"border-r border-neutral-3 pr-4",children:[o(h.Paragraph,{className:"flex items-baseline !mb-0 !mt-2",children:[a(h.Title,{heading:6,className:"mb-0",children:"\u7528\u6237\u7EC4"}),a(E,{icon:a(w,{}),type:"primary",size:"small",className:"ml-auto",loading:j||T.loading,onClick:()=>{m(v.create)},children:"\u6DFB\u52A0"})]}),!j&&!(l==null?void 0:l.length)?a(z,{}):null,a(X,{loading:j||T.loading,data:l,titleKey:"roleName",active:e==null?void 0:e.id,onUpdate:t=>{x(t),m(v.edit)},onActive:t=>{b(t)},onDelete:t=>I.run(t.id)})]}),e?o(F.Col,{span:9,className:"border-neutral-3 pr-4",children:[a(h.Paragraph,{className:"flex items-baseline !mb-0 !mt-2",children:a(h.Title,{heading:6,className:"mb-0",children:"\u529F\u80FD\u6743\u9650"})}),a(H,{checkable:!0,autoExpandParent:!0,checkStrictly:!0,checkedKeys:s,onCheck:(t,_)=>{r(t)},fieldNames:{title:"menuName",key:"menuId"},renderTitle:t=>o("div",{children:[a("span",{className:"mr-2",children:t.menuName}),a(V,{size:"small",menuType:t.menuType})]}),treeData:S.data||[]}),o("div",{className:"mt-10 flex justify-center gap-4",children:[a(J,{deleteRequest:()=>u.remove(e==null?void 0:e.id).then(t=>(g(),t))}),a(E,{type:"primary",loading:C.loading,onClick:()=>{C.run(y(p({},e),{menuIds:s}))},children:"\u4FDD\u5B58"})]})]}):null]}),a(O,y(p({unmountOnExit:!0},Y),{confirmLoading:d==null?void 0:d.loading,onCancel:()=>{x(null),m(null),c.resetFields()},onOk:async()=>{const t=await c.validate();i===v.create?d.run(t):(await C.run(t),x(null))},visible:!!i,title:`${Z[i]}\u7528\u6237\u7EC4`,children:a(Q,{initialValues:D,form:c,labelLength:8,span:24,formItemConfigList:[{schema:{label:"\u7528\u6237\u7EC4\u540D\u79F0",span:12,field:"roleName",required:!0},control:"input"}]})}))]})})})}export{Te as default};
