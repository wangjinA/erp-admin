var M=Object.defineProperty,R=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var P=(n,s,r)=>s in n?M(n,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[s]=r,p=(n,s)=>{for(var r in s||(s={}))L.call(s,r)&&P(n,r,s[r]);if(k)for(var r of k(s))w.call(s,r)&&P(n,r,s[r]);return n},y=(n,s)=>R(n,q(s));import{r as h,bc as B,af as N,b as a,j as o,aI as F,i as b,B as E,aV as K,Z as z,bh as H,M as O}from"./vendor.581b77cf.js";/* empty css               */import{MenuTypeTag as V}from"./index.e0cc53da.js";import{w as G,s as U}from"./index.db58e438.js";import{r as u,a as W,A as Z,P as $,F as J}from"./index.8be05bc7.js";import{L as Q}from"./index.913b50b4.js";import{S as v,F as X,a as Y}from"./index.16154476.js";import"./statusTag.1d433c1a.js";import"./index.f4301f1e.js";import"./entrepot.1530b3cd.js";import"./index.da423918.js";/* empty css               */import"./shopStore.7a17f05b.js";import"./index.110ec091.js";/* empty css              */import"./index.31bdb461.js";/* empty css               */import"./index.d4629795.js";/* empty css              */import"./style.4b618b1b.js";import"./clipboard.a809cca0.js";/* empty css               */import"./schema.292ea05a.js";/* empty css               */import"./schema.035d054d.js";/* empty css              */function Te(){const n=["0-0","0-1","0-0-2"],[s,r]=h.exports.useState([]);h.exports.useState(n);const[e,f]=h.exports.useState(null),[c]=B(),S=G(),[D,x]=h.exports.useState(null),{data:d,loading:j,run:g}=N(()=>u.get({pageNum:1,pageSize:30}).then(i=>(e||f(i.data.data.list[0]),i.data.data.list))),T=N(()=>(e==null?void 0:e.id)?u.info(e.id).then(i=>{var m,l;r(((l=(m=i.data)==null?void 0:m.data)==null?void 0:l.menuIds)||[])}):null,{refreshDeps:[e==null?void 0:e.id]}),I=N(i=>U(()=>u.remove(i),"\u5220\u9664").then(()=>{(e==null?void 0:e.id)===i&&f(d==null?void 0:d[0]),g()}),{manual:!0});return a(W,{formRef:c,createRequest:u.create,updateRequest:i=>u.update(p(p({},D),i)),refreshRequest:g,children:a(Z.Consumer,{children:({showType:i,setShowType:m,createAction:l,updateAction:C})=>o("div",{className:"bg-white p-4 pb-6",children:[o(F.Row,{gutter:[20,0],children:[o(F.Col,{span:6,className:"border-r border-neutral-3 pr-4",children:[o(b.Paragraph,{className:"flex items-baseline !mb-0 !mt-2",children:[a(b.Title,{heading:6,className:"mb-0",children:"\u7528\u6237\u7EC4"}),a(E,{icon:a(K,{}),type:"primary",size:"small",className:"ml-auto",loading:j||T.loading,onClick:()=>{m(v.create)},children:"\u6DFB\u52A0"})]}),!j&&!(d==null?void 0:d.length)?a(z,{}):null,a(Q,{loading:j||T.loading,data:d,titleKey:"roleName",active:e==null?void 0:e.id,onUpdate:t=>{x(t),m(v.edit)},onActive:t=>{f(t)},onDelete:t=>I.run(t.id)})]}),e?o(F.Col,{span:9,className:"border-neutral-3 pr-4",children:[a(b.Paragraph,{className:"flex items-baseline !mb-0 !mt-2",children:a(b.Title,{heading:6,className:"mb-0",children:"\u529F\u80FD\u6743\u9650"})}),a(H,{checkable:!0,autoExpandParent:!0,checkStrictly:!0,checkedKeys:s,onCheck:(t,_)=>{r(t)},fieldNames:{title:"menuName",key:"menuId"},renderTitle:t=>o("div",{children:[a("span",{className:"mr-2",children:t.menuName}),a(V,{size:"small",menuType:t.menuType})]}),treeData:S.data||[]}),o("div",{className:"mt-10 flex justify-center gap-4",children:[a($,{deleteRequest:()=>u.remove(e==null?void 0:e.id).then(t=>(g(),t))}),a(E,{type:"primary",loading:C.loading,onClick:()=>{C.run(y(p({},e),{menuIds:s}))},children:"\u4FDD\u5B58"})]})]}):null]}),a(O,y(p({unmountOnExit:!0},X),{confirmLoading:l==null?void 0:l.loading,onCancel:()=>{x(null),m(null),c.resetFields()},onOk:async()=>{const t=await c.validate();i===v.create?l.run(t):(await C.run(t),x(null))},visible:!!i,title:`${Y[i]}\u7528\u6237\u7EC4`,children:a(J,{initialValues:D,form:c,labelLength:8,span:24,formItemConfigList:[{schema:{label:"\u7528\u6237\u7EC4\u540D\u79F0",span:12,field:"roleName",required:!0},control:"input"}]})}))]})})})}export{Te as default};
