import{r as s,aj as x,H as v,j as i,b as e,n as E,B as S,M as B,t as _,I as N,D as H,aW as K,E as G,aK as T,a1 as J,am as Q}from"./vendor.475cee01.js";import{W as m,S as U,L as l,k as A}from"./index.b2d919ca.js";/* empty css               *//* empty css               */import{a as W}from"./index.4f759f94.js";import{ModalWidth as X}from"./index.a56d10ed.js";import{s as O,f as Y}from"./index.9a618fcf.js";import{D as Z}from"./index.ab849bc2.js";import"./index.7f218578.js";import"./shopStore.936c9d2c.js";import"./index.cc99a160.js";/* empty css              */import"./index.599b9453.js";import"./index.36bc3114.js";/* empty css              */import"./style.4b618b1b.js";import"./clipboard.a809cca0.js";/* empty css               */import"./entrepot.95f11770.js";import"./schema.524eafb7.js";/* empty css               */import"./schema.035d054d.js";var ve=()=>{var y;const[R,h]=s.exports.useState(),[r,p]=s.exports.useState(),[n,C]=s.exports.useState(),[g,D]=s.exports.useState([]),[V,P]=s.exports.useState(0),[o,b]=s.exports.useState(),[F,d]=s.exports.useState(""),f=s.exports.useRef(),{run:z,loading:M}=x(async()=>(n==null?void 0:n.serviceCharge)===void 0?v.error({content:"\u8BF7\u586B\u5199\u4E0A\u67B6\u670D\u52A1\u8D39",duration:2500}):(n==null?void 0:n.putStorageProductVOS.every(t=>!t.receiveProductCount))?v.error({content:"\u8BF7\u81F3\u5C11\u8F93\u5165\u4E00\u4E2A\u6536\u8D27\u6570\u91CF",duration:2500}):O(()=>m.warehousing(n)).then(()=>{p(null),f.current.refreshSearchTable()}),{manual:!0}),{run:$,data:j,loading:c}=x(async t=>{if(t)return m.logs(t).then(u=>u.data.data.list)},{manual:!0}),{run:q,loading:k}=x(async()=>!(o==null?void 0:o.id)||F===void 0?v.error({content:"\u8BF7\u586B\u5199\u5907\u6CE8\u4FE1\u606F",duration:2500}):O(()=>m.setRemark({id:o.id,remarks:F})).then(()=>{b(null),d(""),f.current.refreshSearchTable()}),{manual:!0});return i("div",{className:"bg-white p-4",children:[e(U,{ref:f,name:"\u5165\u5E93\u8BA2\u5355",getListRequest:m.getList,tableProps:{scroll:{x:1350}},formItemConfigList:[{schema:{label:"\u7533\u8BF7\u4FE1\u606F",field:"storageCode"},isSearch:!0,width:230,render(t,u){return i("div",{children:[e(l,{label:"\u7F16\u7801",value:u.storageCode}),e(l,{label:"\u7533\u8BF7\u4EBA",value:u.userName}),e(l,{label:"\u7528\u6237\u7F16\u53F7",value:u.tenantryNo}),e(l,{label:"\u6240\u5C5E\u4ED3\u5E93",value:e(W,{value:u.sendWarehouse})})]})}},{schema:{label:"\u5546\u54C1\u4FE1\u606F",field:"logisticsProductList"},width:320,render(t){return e("div",{children:t.map(u=>i("div",{className:"flex items-center",children:[e(A,{data:u}),e(E,{color:"blue",children:`${u.sendProductCount||0}/${u.receiveProductCount||0}`})]},u.id))})}},{schema:{label:"\u5546\u54C1\u540D\u79F0",field:"productName"},isSearch:!0,hideTable:!0},{schema:{label:"\u5FEB\u9012\u5355\u53F7",field:"expressNo"},width:120,isSearch:!0,render(t){return t}},{schema:{label:"\u53D1\u8D27/\u6536\u8D27\u6570\u91CF",field:"sendProductCount"},width:160,render(t,u){return e(E,{color:"blue",children:`${u.sendProductCount||0}/${u.receiveProductCount||0}`})}},{schema:{label:"\u4E0A\u67B6\u670D\u52A1\u8D39",field:"serviceCharge"},width:120},{schema:{label:"\u72B6\u6001",field:"storageStatus"},width:100,isSearch:!0,control:"dictSelector",controlProps:{dictCode:"storage_status"},render(t){return e(Z,{dictCode:"storage_status",value:t})}},{schema:{label:"\u521B\u5EFA\u65F6\u95F4",field:"createTime"},width:160},{schema:{label:"\u5907\u6CE8",field:"remarks"},width:120,isSearch:!0,render(t){return t||"-"}},{schema:{label:"\u64CD\u4F5C",field:"actions"},width:150,render(t,u){return i("div",{children:[["3","4"].includes(u.storageStatus)?null:e(S,{type:"text",size:"small",status:"default",loading:c,onClick:()=>{console.log(u.logisticsProductList),C({applyId:u.id,putStorageProductVOS:u.logisticsProductList.map(a=>({id:a.id,logisticsProductId:a.logisticsProductId,productStorageId:a.productStorageId,receiveProductCount:a.sendProductCount||0})),sendWarehouse:u.sendWarehouse,serviceCharge:void 0}),D(u.logisticsProductList.map(a=>a.sendProductCount)),P(0),p(u)},children:"\u5165\u5E93"}),e(S,{type:"text",size:"small",status:"warning",loading:c,onClick:()=>{h(u),$(u.id)},children:"\u64CD\u4F5C\u8BB0\u5F55"}),e(S,{type:"text",size:"small",status:"success",loading:k,onClick:()=>{b(u),d(u.remarks||"")},children:"\u5907\u6CE8"})]})}}]}),e(B,{style:{width:X},visible:!!r,title:"\u5165\u5E93\u7533\u8BF7",onCancel:()=>p(null),confirmLoading:M,onOk:async()=>{z()},okText:"\u5165\u5E93",children:i("div",{children:[i(_,{direction:"vertical",children:[e(l,{label:"\u4ED3\u5E93\u540D\u79F0",value:e(W,{value:r==null?void 0:r.sendWarehouse})}),e(l,{label:"\u5FEB\u9012\u5355\u53F7",value:(y=r==null?void 0:r.expressNo)==null?void 0:y.split(",").map(t=>e(E,{color:"blue",children:t},t))}),e(l,{className:"flex",label:"\u4E0A\u67B6\u670D\u52A1\u8D39",value:e(N,{value:V,size:"mini",placeholder:"\u8BF7\u8F93\u5165",suffix:"\u5143",onChange:t=>{P(t),C(u=>(u.serviceCharge=t,u))}})})]}),e(H,{}),e(K,{size:"small",data:r==null?void 0:r.logisticsProductList,columns:[{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:"goodsInfo",width:250,render(t,u){return e(A,{data:u})}},{width:120,title:"\u5546\u54C1\u6570\u91CF",dataIndex:"sendProductCount"},{title:"\u6536\u8D27\u6570\u91CF",dataIndex:"receiveProductCount",render(t,u,a){return e(N,{value:g[a],placeholder:"\u8BF7\u8F93\u5165",defaultValue:t,suffix:"\u4EF6",onChange:L=>{g[a]=L,D([...g]),C(I=>(I.putStorageProductVOS[a].receiveProductCount=L,I))}})}}]})]})}),e(B,{title:"\u64CD\u4F5C\u8BB0\u5F55",visible:R,onCancel:()=>h(null),cancelText:"\u5173\u95ED",unmountOnExit:!0,onOk:async()=>{h(null)},children:e(G,{loading:c,className:"mx-auto block max-h-96 overflow-y-auto",children:!c&&j?e(T,{children:j.map(t=>i(T.Item,{label:t.operationContent||"-",children:[e("span",{children:t.operationProcedure}),e("span",{className:"text-gray-500",children:Y(t.createTime)})]},t.id))}):e(J,{description:"\u6682\u65E0\u8BB0\u5F55"})})}),e(B,{title:"\u8BBE\u7F6E\u5907\u6CE8",visible:!!o,onCancel:()=>{b(null),d("")},confirmLoading:k,onOk:q,okText:"\u4FDD\u5B58",cancelText:"\u53D6\u6D88",unmountOnExit:!0,children:e("div",{className:"py-4",children:e(Q.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",value:F,onChange:t=>d(t),rows:4,maxLength:500,showWordLimit:!0})})})]})};export{ve as default};
