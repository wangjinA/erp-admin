var Q=Object.defineProperty;var F=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var H=(s,a,t)=>a in s?Q(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,S=(s,a)=>{for(var t in a||(a={}))X.call(a,t)&&H(s,t,a[t]);if(F)for(var t of F(a))Y.call(a,t)&&H(s,t,a[t]);return s};import{r as i,bc as T,af as r}from"./vendor.581b77cf.js";import{r as f,e as w}from"./entrepot.937b7e14.js";import{S as x}from"./index.16154476.js";import{s as c}from"./index.25c2c087.js";function ae(s){const{isPureList:a}=s,[t,L]=i.exports.useState(),[b,y]=i.exports.useState(x.edit),[k]=T(),[p]=T(),[n,E]=i.exports.useState(null),[v,h]=i.exports.useState(null),[d,l]=i.exports.useState(null),{data:j,loading:A,run:g}=r(async e=>{if(a)return[];p.resetFields(),l(null);const o=S({pageNum:1,pageSize:100,entrepotId:n==null?void 0:n.id},e);if(!o.entrepotId)return[];const R=await f.getList(o),{list:u}=R.data.data;if(u.length){const I=u.find(O=>O.id===(d==null?void 0:d.id))||u[0];l(I),p.setFieldsValue(I)}return u},{manual:!1,refreshDeps:[n],debounceWait:300}),{run:m,data:D,loading:P}=r(async()=>{const e=await w.getList({pageNum:1,pageSize:100,entrepotType:1}),{list:o}=e.data.data.data;if(o.length){const R=o.find(u=>u.id===(n==null?void 0:n.id))||o[0];E(R)}return o}),{run:z,loading:N}=r(async e=>{debugger;await c(()=>w.insert(e)),L(null),m()},{manual:!0}),{run:q,loading:M}=r(async e=>{await c(()=>w.update(e)),L(null),m()},{manual:!0}),{run:U,loading:V}=r(async e=>{await c(()=>f.insert(S({entrepotId:n.id},e))),p.resetFields(),await g({entrepotId:n.id})},{manual:!0}),{run:W,loading:B}=r(async e=>{await c(()=>f.remove(e)),l(null),await g({entrepotId:n.id})},{manual:!0}),{run:C,loading:G}=r(async e=>{await c(()=>w.remove(e)),E(null),m()},{manual:!0}),{run:J,loading:K}=r(async e=>{await c(()=>f.update(e)),l(null),g({entrepotId:n.id})},{manual:!0});return i.exports.useEffect(()=>{y(d?x.edit:x.create)},[d]),i.exports.useEffect(()=>{t||(h(null),k.clearFields())},[t,k]),{showTypeEntrepot:t,setShowTypeEntrepot:L,formEntrepotRef:k,formRacksRef:p,activeEntrepot:n,setActiveEntrepot:E,racksList:j,rackLoading:A,getRacksList:g,createEntrepotHandler:z,createEntrepotLoading:N,getEntrepotList:m,entrepotList:D,entrepotLoading:P,showTypeRacks:b,setShowTypeRacks:y,activeRacks:d,setActiveRacks:l,createRacksLoading:V,createRacksHandler:U,removeRacksHandler:W,removeRacksLoading:B,updateRacksHandler:J,updateRacksLoading:K,updateEntrepotHandler:q,updateEntrepotLoading:M,removeEntrepotHandler:C,removeEntrepotLoading:G,updateEntrepotData:v,setUpdateEntrepotData:h}}export{ae as useEntrepotInfo};
