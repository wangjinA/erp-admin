var Le=Object.defineProperty,Ie=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var fe=(a,u,s)=>u in a?Le(a,u,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[u]=s,f=(a,u)=>{for(var s in u||(u={}))pe.call(u,s)&&fe(a,s,u[s]);if(ee)for(var s of ee(u))ge.call(u,s)&&fe(a,s,u[s]);return a},v=(a,u)=>Ie(a,we(u));var ne=(a,u)=>{var s={};for(var t in a)pe.call(a,t)&&u.indexOf(t)<0&&(s[t]=a[t]);if(a!=null&&ee)for(var t of ee(a))u.indexOf(t)<0&&ge.call(a,t)&&(s[t]=a[t]);return s};import{r as g,af as N,d as o,F as y,j as e,B as C,z as le,M as I,E as ie,aW as ae,aX as oe,ay as Fe,am as re,an as je,c as S,n as ce,ag as be,t as W,o as Ee,ak as Te,S as _e,aY as Re,s as Ve,aQ as xe,l as We,aZ as Ne,Q as $e,aG as Me,a_ as ze,aB as He}from"./vendor.7897a533.js";import{b as p,i as Ce,c as ue}from"./index.80f47301.js";import{f as qe,a as b,s as te}from"./index.627cc3c6.js";/* empty css              */import{o as G}from"./order.06171118.js";import{e as U}from"./express.daedb911.js";import{M as Ge}from"./index.ed792330.js";import{P as se}from"./index.15739c72.js";import{F as Q}from"./index.0400ad0b.js";import{E as De,a as ve}from"./index.5c74a6e5.js";import{u as de,D as ke}from"./index.c8b77bef.js";import{T as Ue}from"./index.8f388ae4.js";import{s as Qe,e as Ye}from"./entrepot.369b13c8.js";import{S as Y}from"./index.70508b9f.js";import{OrderCreateSchema2 as Ke}from"./schema.e905735b.js";import{S as Xe}from"./index.c54ab730.js";const T={getList(a){return p.post("/api/logistics/order/list",a)},getDetail(a){return p.get(`/api/logistics/order/info/${a}`)},insert(a){return p.post("/api/logistics/order/insert",a)},refresh(a){return p.get(`/api/logistics/order/update/shopee/${a}`)},remove(a){return p.get(`/api/logistics/order/remove/${a}`)},getSheet(a){return p.get(`/api/logistics/order/view/sheet/${a}`)},getLog(a){return p.post("/api/logistics/order/log/list",{pageNum:1,pageSize:30,orderId:a})},update(a){return p.post("/api/logistics/order/update",a)},cancelPack(a){return p.get(`/api/logistics/order/cancel/${a}`)},getShopOrderCount(a){return p.post("/api/logistics/order/fetch/store/count",a)},getPackCount(a){return p.post("/api/logistics/order/fetch/package/count",a)},addProduct(a){return p.post("/api/logistics/order/add/product",a)},syncOrder(a){return p.post("/api/logistics/order/synchronous/order",a)}};var Be=a=>{var r,h,d;const{buttonProps:u,id:s}=a,[t,l]=g.exports.useState(!1),i=N(async()=>T.getLog(s).then(c=>c.data),{manual:!0});return o(y,{children:[e(C,v(f({icon:e(le,{}),onClick:()=>{i.run(),l(!0)}},u),{children:"\u64CD\u4F5C\u8BB0\u5F55"})),e(I,{title:"\u64CD\u4F5C\u8BB0\u5F55",visible:t,onCancel:()=>l(!1),cancelText:"\u5173\u95ED",unmountOnExit:!0,onOk:async()=>{l(!1)},children:e(ie,{loading:i.loading,className:"mx-auto block max-h-96 overflow-y-auto",children:!i.loading&&((h=(r=i.data)==null?void 0:r.data.list)==null?void 0:h.length)?e(ae,{children:(d=i.data)==null?void 0:d.data.list.map(c=>o(ae.Item,{label:c.operationContent||"-",children:[e("span",{children:c.operationProcedure}),e("span",{className:"ml-4 text-gray-500",children:qe(c.createTime)})]},c.id))}):e(oe,{description:"\u6682\u65E0\u8BB0\u5F55"})})})]})},ye=({orderItem:a,buttonProps:u})=>{const[s,t]=g.exports.useState("");g.exports.useEffect(()=>{},[a]);const{run:l,loading:i}=N(async()=>{var h;let r=(h=a==null?void 0:a.orderPackageList)==null?void 0:h.reduce((d,c)=>d||c.documentUrl,"");if(!r){const d=await b(()=>G.createShellOrder(a.id),"\u67E5\u770B\u9762\u5355").then(c=>{var x;return(x=c.data.data)==null?void 0:x.list});r=d==null?void 0:d[0]}t(r)},{manual:!0});return o(y,{children:[u?e(C,v(f({loading:i,icon:e(le,{}),onClick:()=>{l()}},u),{children:"\u67E5\u770B\u9762\u5355"})):o(Fe,{className:"text-sm",type:"text",icon:e(le,{}),onClick:()=>{l()},children:["\u67E5\u770B\u9762\u5355",i?e(ie,{size:12}):""]}),e(I,{title:"\u9762\u5355\u4FE1\u606F",style:{width:800},visible:!!s,onCancel:()=>{t("")},hideCancel:!0,onConfirm:()=>{t("")},children:e("iframe",{className:"h-[700px] w-full border-none outline-none",src:s})})]})};re.extend(je);function Ze(a,u){const s=re(),t=re(a).diff(s),l=re.duration(t),i=Math.floor(l.asDays()),r=l.hours(),h=l.minutes();return t<=0?{expired:!0,dateStr:"\u903E\u671F"}:{expired:!1,dateStr:`\u5269\u4F59${i}\u5929${r}\u5C0F\u65F6${h}\u5206\u949F${u}`}}var Je=({data:a})=>{var t;const{data:u}=de({dictCode:"shopee_status"}),s=Ze(a.shipByDate,"\u53D1\u8D27");return a.createType==="0"?o(y,{children:[o("div",{children:[e("span",{className:w,children:"Shopee\u72B6\u6001\uFF1A"}),e("span",{className:O,children:((t=u==null?void 0:u.find(l=>l.value===a.shopeeStatus))==null?void 0:t.label)||"-"})]}),o("div",{children:[e("span",{className:w,children:"\u5E97\u94FA\uFF1A"}),e("span",{className:O,children:e(Xe,{value:a.platformShopId})})]}),e("div",{className:"ml-auto",children:e("span",{className:S(O,"text-red-500 font-bold"),children:a.shipByDate?`${s.dateStr}`:""})})]}):o("div",{children:[e("span",{className:w,children:"\u8BA2\u5355\u7C7B\u578B\uFF1A"}),e("span",{className:O,children:"\u8DE8\u5883 \u53F0\u6E7E/\u81EA\u5EFA"})]})};function ea(a){return{all:a=a||new Map,on:function(u,s){var t=a.get(u);t?t.push(s):a.set(u,[s])},off:function(u,s){var t=a.get(u);t&&(s?t.splice(t.indexOf(s)>>>0,1):a.set(u,[]))},emit:function(u,s){var t=a.get(u);t&&t.slice().map(function(l){l(s)}),(t=a.get("*"))&&t.slice().map(function(l){l(u,s)})}}}var F;(function(a){a.refreshOrderPage="refresh-order-page",a.clearSelectOrderList="clear-select-order-list"})(F||(F={}));const E=ea();function aa(a,u){g.exports.useEffect(()=>(E.on(a,u),()=>{E.off(a,u)}),[a,u])}var ra=a=>{const{buttonProps:u,ids:s,children:t}=a,l=N(async()=>{if(!(s==null?void 0:s.length))return ce.error("\u8BF7\u9009\u62E9\u8BA2\u5355");await b(()=>Ce()?G.refresh(s):T.refresh(s[0]),"\u66F4\u65B0"),E.emit(F.refreshOrderPage)},{manual:!0});return e(y,{children:e(C,v(f({type:"text",status:"warning",loading:l.loading,onClick:()=>{l.run()}},u),{children:t||"\u66F4\u65B0\u8BA2\u5355"}))})},ua={"order-table":"_order-table_dhx5k_1"},m=({label:a,value:u,className:s,labelClassName:t,valueClassName:l})=>o("div",{className:S("break-all mb-1",s),children:[o("span",{className:S(w,t),children:[a,"\uFF1A"]}),e("span",{className:S(O,l),children:u||"-"})]});const ta=a=>{const{visible:u,sendWarehouse:s,trackingNo:t,setVisible:l,onSuccess:i}=a,[r]=be.useForm(),h=N(async()=>{const d=await r.validate();await b(()=>U.returnOperation(d)),i==null||i(),l(!1)},{manual:!0});return e(I,{title:"\u65B0\u589E\u9000\u4EF6\u5FEB\u9012",visible:u,confirmLoading:h.loading,onCancel:()=>{l(!1)},onOk:()=>{h.run()},children:e(Q,{initialValues:{sendWarehouse:s,trackingNo:t},span:24,form:r,formItemConfigList:[{schema:{field:"sendWarehouse",label:"\u6253\u5305\u4ED3\u5E93"},control:e(De,{})},{schema:{field:"trackingNo",label:"\u7269\u6D41\u5355\u53F7",required:!0}},{schema:{field:"recipientsInfo",label:"\u6536\u4EF6\u4FE1\u606F",required:!0},formItemProps:{extra:"\u4F8B\uFF1A\u5F20\u4E09\uFF0C15270848182\uFF0C\u4E1C\u839E\u5E02xx\u9547\u5357\u57CE\u8857\u9053A\u533A3\u680Bxx\u53F7"},control:"textarea"},{schema:{field:"storeRemark",label:"\u5907\u6CE8"},formItemProps:{extra:e("span",{className:"text-red-600",children:"\u5982\u662F\u4E0A\u95E8\u53D6\u4EF6\uFF0C\u8BF7\u52A1\u5FC5\u586B\u5199\u53D6\u4EF6\u7801\uFF01"})},control:"textarea"}]})})};var sa=ta;const Pe=["","green","orangered","orange","gold","lime","cyan","blue","arcoblue","purple","pinkpurple","magenta","gray"];function na(a){var l;const{data:u}=de({dictCode:"tracking_status"}),s=(l=u==null?void 0:u.find(i=>i.value===a.trackingStatus))==null?void 0:l.label,t=Pe[Number(a.trackingStatus)];return e(y,{children:e(Ge,{status:"default",style:{transform:" translateY(-2px)"},color:t,text:s})})}function la(a){const{item:u,sendWarehouse:s,data:t}=a,[l,i]=g.exports.useState(!1),r=N(async()=>{await b(()=>U.addReject({orderId:t.id,trackingNo:u.trackingNo}),"\u5FEB\u9012\u62D2\u6536\u7533\u8BF7"),E.emit(F.refreshOrderPage)},{manual:!0}),h=N(async()=>{await b(()=>U.orderCancelReject({orderId:t.id,trackingNo:u.trackingNo}),"\u53D6\u6D88\u62D2\u6536"),E.emit(F.refreshOrderPage)},{manual:!0});if(u.trackingNo)switch(u.trackingStatus){case"0":return e("div",{children:e(W,{className:"cursor-pointer",bordered:!0,size:"small",color:"orange",checked:!0,onClick:async()=>{await te({confirmLoading:r.loading,content:`\u6240\u6709\u8DDF\u5FEB\u9012\u5355\u53F7"${u.trackingNo}"\u6709\u5173\u8054\u7684\u8BA2\u5355\u90FD\u4F1A\u62D2\u6536\uFF0C\u786E\u5B9A\u8981\u7EE7\u7EED\u5417\uFF1F`}),r.run()},children:"\u62D2\u6536"})});case"1":return o("div",{children:[e(W,{className:"cursor-pointer",bordered:!0,size:"small",color:"orange",checked:!0,onClick:async()=>{i(!0)},children:"\u9000\u4EF6"}),e(sa,{visible:l,setVisible:i,sendWarehouse:s,trackingNo:u.trackingNo,onSuccess:()=>{E.emit(F.refreshOrderPage)}})]});case"2":return e("div",{children:e(se,{title:"\u786E\u5B9A\u53D6\u6D88\u62D2\u6536\u5417\uFF1F",onOk:async()=>{h.run()},children:e(W,{className:"cursor-pointer",bordered:!0,size:"small",color:"orange",checked:!0,children:"\u53D6\u6D88\u62D2\u6536"})})});case"4":return e("div",{children:e(se,{title:"\u786E\u5B9A\u53D6\u6D88\u9000\u4EF6\u5417\uFF1F",onOk:async()=>{await b(()=>U.orderCancelReturn({orderId:t.id,trackingNo:u.trackingNo}),"\u9000\u4EF6\u53D6\u6D88"),E.emit(F.refreshOrderPage)},children:e(W,{className:"cursor-pointer",bordered:!0,size:"small",color:"orange",checked:!0,children:"\u53D6\u6D88\u9000\u4EF6"})})})}return e("div",{children:"-"})}const ia=a=>{var s;const{data:u}=a;return e("div",{className:S(ua["goods-info"],"pr-2"),children:(s=u.orderProductVOList)==null?void 0:s.map((t,l)=>e("div",{className:S("h-[125px] border-r",l>0?"border-t":""),children:o("div",{className:"h-full p-2",children:[e(m,{label:"\u5FEB\u9012",value:t.trackingNo?e(Ue,{value:t.trackingNo}):e(W,{children:"\u672A\u586B"})}),t.trackingNo?o(y,{children:[e(m,{label:"\u72B6\u6001",value:e(na,f({},t))}),["0","1","2"].includes(u.orderStatus)&&ue()?e(m,{valueClassName:"inline-flex",label:"\u64CD\u4F5C",value:e(la,{data:u,item:t,sendWarehouse:u.sendWarehouse})}):null]}):null,t.freightSpaceName?e(m,{label:"\u4ED3\u4F4D",value:t.freightSpaceName}):null]})},l))})};var oa=a=>{const r=a,{buttonProps:u,onSuccess:s}=r,t=ne(r,["buttonProps","onSuccess"]),{loading:l,run:i}=N(async()=>{await b(()=>Qe.ScanOut(t)),s()},{manual:!0});return e(y,{children:e(se,{title:"\u786E\u5B9A\u51FA\u5E93\uFF1F",buttonProps:{loading:l},onOk:()=>{i()},disabled:u==null?void 0:u.disabled,children:e(C,v(f({type:"text",status:"warning",loading:l},u),{children:"\u5305\u88F9\u51FA\u5E93"}))})})};const ca={sender_real_name:{schema:{label:"\u5BC4\u4EF6\u4EBA\u59D3\u540D",field:"senderRealName",required:!0}},tracking_no:{schema:{label:"\u7269\u6D41\u5355\u53F7",field:"trackingNo",required:!0}}};var da=a=>{var B;const $=a,{orderItem:u,buttonProps:s,onSuccess:t}=$,l=ne($,["orderItem","buttonProps","onSuccess"]),[i,r]=g.exports.useState([]),[h,d]=g.exports.useState({}),[c]=be.useForm(),{loading:x,run:D}=N(async()=>{const P=await c.validate();await b(()=>G.shipment(v(f({},P),{orderId:u.id})),"\u51FA\u8D27"),E.emit(F.refreshOrderPage),r([])},{manual:!0}),L=N(async()=>{var X,j,M,z,H,R,Z,q;const[P,_]=await Promise.all([G.getShippingParameter(u.id),Ye.getSenderAll({entrepotId:u.sendWarehouse})]),K=((j=(X=_==null?void 0:_.data)==null?void 0:X.data)==null?void 0:j.list)||[];d({senderRealName:((M=K.find(V=>V.isDefault))==null?void 0:M.details)||((z=K[0])==null?void 0:z.details)||""}),r(((q=(Z=(R=(H=P==null?void 0:P.data)==null?void 0:H.data)==null?void 0:R.infoNeeded)==null?void 0:Z.dropoff)==null?void 0:q.map(V=>ca[V]))||[])},{manual:!0});return o(y,{children:[e(C,v(f({type:"text",status:"success",loading:L.loading,disabled:!!((B=u==null?void 0:u.orderPackageList)==null?void 0:B.some(P=>P.documentUrl)),onClick:()=>{L.run()}},s),{children:"\u5B89\u6392\u51FA\u8D27"})),e(I,{title:"\u7533\u8BF7\u5BC4\u4EF6\u7F16\u53F7",visible:!!i.length,onCancel:()=>{r([])},unmountOnExit:!0,confirmLoading:x,onOk:async()=>{D()},children:e(Q,{span:24,form:c,initialValues:h,formItemConfigList:i})})]})},ha={"goods-info":"_goods-info_7um5o_1"},Ae=a=>{const{data:u,isEdit:s,onChange:t}=a,l=g.exports.useRef(u);return e("div",{style:{height:"max-content",overflow:"hidden"},className:"arco-list-style",children:e(Ee,{className:S(ha["goods-info"]),dataSource:u||[],bordered:s,render:(i,r)=>o("div",{className:S(["grid","h-[125px]",{"grid-cols-2":s},r>0?"border-t":""]),children:[e(Ee.Item.Meta,{className:"!items-center p-2 w-full",avatar:e(Te,{className:"size-24",src:i.productImg[0]}),title:i.productName,description:o("div",{children:[e(m,{className:"!mb-0",labelClassName:"!text-sm !pr-1 !align-baseline",valueClassName:"!text-sm",label:"\u5355\u2003\u2003\u4EF7",value:i.unitPrice}),e(m,{className:"!mb-0",labelClassName:"!text-sm !pr-1 !align-baseline",valueClassName:"!text-sm",label:"\u6570\u2003\u2003\u91CF",value:i.quantity}),e(m,{className:"!mb-0",labelClassName:"!text-sm !pr-1 !align-baseline",valueClassName:"!text-sm",label:"\u89C4\u683C\u540D\u79F0",value:i.specificationName}),e(m,{className:"!mb-0",labelClassName:"!text-sm !pr-1 !align-baseline",valueClassName:"!text-sm",label:"\u89C4\u683CSKU",value:i.sku})]})}),s?e("div",{className:"border-l pl-2",children:e(Q,{initialValues:i,onChange:(h,d)=>{l.current[r]=d,t==null||t(l.current)},formItemConfigList:[{schema:{label:"\u53D1\u8D27\u65B9\u5F0F",field:"deliveryMethod",span:16},control:e(ke,{dictCode:"transport_type",type:"radio"})},{schema:{label:"",field:"stockOutStatus",span:8},formItemProps:{triggerPropName:"checked"},control:e(_e,{checkedText:"\u7F3A\u8D27\u6253\u5305",uncheckedText:"\u7F3A\u8D27\u6253\u5305"})},{schema:{label:"\u5FEB\u9012\u5355\u53F7",field:"trackingNo",span:24}}]})}):null]},i.id)})})};const ma={getRejectList(a){return p.post("/api/reject/management/list",a)},cancelReject(a){return p.get(`/api/reject/management/cancel/${a}`)},getReturnList(a){return p.post("/api/return/management/list",a)},cancelReturn(a){return p.get(`/api/return/management/cancel/${a}`)},getOrderTrack(a){return p.get(`${a}`)}};var pa=({orderItem:a})=>{var i,r,h;const[u,s]=g.exports.useState(!1),t=N(async()=>(ue()?U.getOrderTrack(a.id):ma.getOrderTrack(a.id)).then(c=>{var x,D;return(D=(x=c.data)==null?void 0:x.data)==null?void 0:D.trackingInfoItemVOList}).then(c=>(s(!0),c)).catch(c=>(ce.error("\u67E5\u770B\u5931\u8D25\uFF0C\u6682\u65E0\u7269\u6D41\u8DDF\u8E2A\u4FE1\u606F"),[])),{manual:!0}),l=(i=a==null?void 0:a.orderPackageList[0])==null?void 0:i.trackingNumber;return l?o(y,{children:[e(Fe,{disabled:t.loading,className:"!inline",onClick:()=>{t.run()},children:l}),e(ye,{orderItem:a}),e(I,{confirmLoading:t.loading,title:"\u7269\u6D41\u4FE1\u606F",visible:u,onCancel:()=>{s(!1)},hideCancel:!0,onConfirm:()=>{s(!1)},children:((r=t.data)==null?void 0:r.length)?e(ae,{children:(h=t.data)==null?void 0:h.map(d=>e(ae.Item,{label:d.updateTime,children:d.description},d.updateTime))}):e(oe,{description:"\u6682\u65E0\u7269\u6D41\u8DDF\u8E2A\u4FE1\u606F"})})]}):e(y,{children:"-"})};function Se(a){const{dictCode:u}=a,{pathname:s}=Re(),t=g.exports.useMemo(()=>["/client/order/all"].includes(s),[s]),l=Ce();return[{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:"orderProductVOList",width:550,render(i){return e(Ae,{data:i})},fixed:"left"},{title:"\u53D1\u8D27\u4FE1\u606F",dataIndex:"orderProductVOList_1",width:210,render(i,r){return e(ia,{data:r})}},{title:"\u7269\u6D41\u4FE1\u606F",dataIndex:"logistics",width:240,render(i,r){var h;return o("div",{className:"border-r h-full p-2",children:[e(m,{label:"\u5C3E\u7A0B\u7269\u6D41",value:(h=r.orderPackageList[0])==null?void 0:h.shippingCarrier}),e(m,{label:"\u7269\u6D41\u5355\u53F7",value:e(pa,{orderItem:r})}),r.shippingTime?e(m,{label:"\u51FA\u8D27\u65F6\u95F4",value:r.shippingTime}):null]})}},...t?[{title:"\u4E70\u5BB6\u4FE1\u606F",dataIndex:"seller",width:180,render(i,r){return o("div",{className:"border-r h-full p-2",children:[e(m,{label:"\u4E70\u5BB6",value:r.buyerUsername}),e(m,{label:"\u6536\u8D27\u4EBA",value:r.recipients}),e(m,{label:"\u6536\u8D27\u7535\u8BDD",value:r.mobileNumber}),e(m,{label:"\u6536\u8D27\u5730\u5740",value:r.detailedAddress})]})}}]:[],{title:"\u6253\u5305\u4FE1\u606F",dataIndex:"db",width:150,render(i,r){return o("div",{className:"border-r h-full p-2",children:[e(m,{label:"\u6253\u5305\u4ED3\u5E93",value:e(ve,{value:r.sendWarehouse})}),e(m,{label:"\u4ED3\u5E93\u5907\u6CE8",value:r.entrepotRemark}),e(m,{label:"\u5356\u5BB6\u5907\u6CE8",value:r.remark})]})}},...t?[{title:"\u5356\u5BB6\u4FE1\u606F",dataIndex:"\u5356\u5BB6\u4FE1\u606F",width:180,render(i,r){return o("div",{className:"border-r h-full p-2",children:[e(m,{label:"\u6253\u5305\u4ED3\u5E93",value:e(ve,{value:r.sendWarehouse})}),e(m,{label:"\u5356\u5BB6\u5907\u6CE8",value:r.remark}),e(m,{label:"\u4ED3\u5E93\u5907\u6CE8",value:r.entrepotRemark})]})}}]:[],{title:"\u8BA2\u5355\u91D1\u989D",dataIndex:"fee",width:200,render(i,r){return o("div",{className:"border-r h-full p-2",children:[e(m,{label:"\u603B\u8D39\u7528(TWD)",value:r.orderAmount}),e(m,{label:"\u9884\u4F30\u8FD0\u8D39(TWD)",value:r.estimatedShippingFee}),e(m,{label:"\u5B9E\u9645\u8FD0\u8D39(TWD)",value:r.actualShippingFee})]})}},...u==="order_status"?[]:[],...l?[{title:"\u64CD\u4F5C",dataIndex:"actions",width:120,render(i,r){return e("div",{className:"h-full p-2 flex justify-center",children:o(Ve,{direction:"vertical",size:4,children:[e(C,{type:"text",size:"small",disabled:["5","6"].includes(r.orderStatus),onClick:async()=>{await te({content:"\u786E\u5B9A\u8981\u53D6\u6D88\u6253\u5305\u5417\uFF1F",onOk(){return b(()=>G.cancel([r.id]),"\u53D6\u6D88\u6253\u5305")}}),E.emit(F.refreshOrderPage)},children:"\u53D6\u6D88\u8BA2\u5355"}),e(oa,{sendWarehouse:r.sendWarehouse,trackingNo:r.trackingNo,shrimpOrderNo:r.shrimpOrderNo,onSuccess:()=>{E.emit(F.refreshOrderPage)},buttonProps:{size:"small",disabled:r.orderStatus!=="2"}}),e(da,{orderItem:r,sendWarehouse:r.sendWarehouse,trackingNo:r.trackingNo,shrimpOrderNo:r.shrimpOrderNo,onSuccess:()=>{E.emit(F.refreshOrderPage)},buttonProps:{size:"small"}}),e(Be,{buttonProps:{type:"text",icon:null},id:r.id})]})})}}]:[]]}var wa=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",useColumns:Se});const w="arco-descriptions-item-label w-auto pb-0",O="arco-descriptions-item-value w-auto pb-0",ga=a=>{var q,V,he,me;const{className:u,style:s,dictCode:t,loading:l,run:i,data:r,pagination:h,onSelect:d}=a;g.exports.useState(!1);const[c,x]=g.exports.useState(),[D,L]=g.exports.useState([]),[$,B]=g.exports.useState(),[P,_]=g.exports.useState(),K=ue(),[X]=xe(),[j]=xe(),M=Se(a);N(async n=>{await b(()=>T.refresh(n))},{manual:!0});const z=N(async n=>{const k=We.exports.omit(c,["orderProductVOList","orderPackageList"]);await b(()=>T.update(v(f({},k),{logisticsOrderProductList:[...k.logisticsOrderProductList,...n?[n]:[]]})),n?"\u6DFB\u52A0":"\u6253\u5305"),B(null),E.emit(F.refreshOrderPage)},{manual:!0}),H=N(async()=>{const n=await j.validate();await b(()=>T.addProduct(f({},n)),"\u6DFB\u52A0"),B(null),E.emit(F.refreshOrderPage)},{manual:!0}),{data:R}=de({dictCode:"order_status"});aa(F.clearSelectOrderList,()=>{L([])}),g.exports.useEffect(()=>{d==null||d(D)},[D]);const Z=g.exports.useMemo(()=>{var n;if(D.length===((n=r==null?void 0:r.list)==null?void 0:n.length))return!0},[D,r==null?void 0:r.list]);return o("div",{className:u,style:s,children:[o("div",{children:[o("header",{className:"flex items-center",children:[d?e(Ne,{disabled:!((q=r==null?void 0:r.list)==null?void 0:q.length),className:"mr-2 pl-[10px]",checked:Z,onChange:n=>{var k;L(n?(k=r==null?void 0:r.list)==null?void 0:k.map(J=>J.id):[])}}):null,M.map(n=>e("div",{className:"font-medium px-4 py-2",style:{width:n.width,flex:n.width?"auto":1},children:n.title},n.dataIndex))]}),e(ie,{className:"block text-center",loading:l,children:e("main",{className:"flex flex-col gap-4 bg-white text-left",children:(V=r==null?void 0:r.list)==null?void 0:V.map(n=>{var J;const k=((J=R==null?void 0:R.find(A=>A.value===n.orderStatus))==null?void 0:J.label)||"\u65E0";return o("div",{className:"border",children:[K?e("header",{className:"flex items-center p-2 border-b",children:o(C.Group,{children:[e(C,{disabled:n.orderStatus&&!["0","1","2"].includes(n.orderStatus),onClick:()=>{B(Y.edit),x(structuredClone(v(f({},n),{clickPack:n.orderStatus==="5"||!n.whetherPack,logisticsOrderProductList:n.orderProductVOList,sendWarehouse:n.sendWarehouse==="0"?void 0:n.sendWarehouse})))},children:n.whetherPack&&n.orderStatus!=="5"?"\u7F16\u8F91\u6253\u5305":"\u4E00\u952E\u6253\u5305"}),e(C,{disabled:!["0"].includes(n.orderStatus),onClick:async()=>{await te({content:"\u786E\u5B9A\u8981\u53D6\u6D88\u6253\u5305\u5417\uFF1F"}),await b(()=>T.cancelPack(n.id),"\u53D6\u6D88\u6253\u5305"),E.emit(F.refreshOrderPage)},children:"\u53D6\u6D88\u6253\u5305"}),e(ye,{orderItem:n,buttonProps:{}}),e(ra,{buttonProps:{type:"default",status:"default"},ids:[n.id]}),e(C,{onClick:()=>{x(v(f({},n),{logisticsOrderProductList:n.orderProductVOList})),B(Y.create)},children:"\u6DFB\u52A0\u5546\u54C1"}),e(C,{onClick:()=>{te({content:"\u786E\u5B9A\u8981\u7533\u8BF7\u9884\u5237\u5417?",okButtonProps:{status:"default"}}).then(()=>{ce.success("\u9884\u5237\u6210\u529F\uFF01")})},children:"\u7533\u8BF7\u9884\u5237"}),e(Be,{id:n.id}),e(se,{title:"\u5220\u9664\u8BA2\u5355",content:"\u786E\u8BA4\u5220\u9664\u8BA2\u5355\uFF1F\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF01",isModal:!0,onOk:async()=>{await b(()=>T.remove(n.id)),i()}})]})}):null,o("header",{className:"gap-12 pl-1 pr-4 py-2 border-b grid grid-cols-[340px_240px_600px_1fr]",children:[o("div",{className:"flex",children:[d?e(Ne,{checked:D.includes(n.id),onChange:A=>{L(A?[...D,n.id]:D.filter(Oe=>Oe!==n.id))}}):null,e($e,{content:"\u6253\u5305\u8BA2\u5355\u72B6\u6001",children:e(W,{bordered:!0,size:"small",className:"mx-2",color:Pe[Number(n.orderStatus)],children:k})}),e("span",{className:w,children:"\u8BA2\u5355\u7F16\u53F7\uFF1A"}),e("span",{className:S(O,"truncate"),children:n.shrimpOrderNo})]}),e(Je,{data:n})]}),e("main",{className:"flex p-1",children:M.map(A=>e("div",{style:{width:A.width,flex:A.width?"auto":1},children:A.render(n[A.dataIndex],n)},A.dataIndex))}),o("footer",{className:"flex border-t py-2 px-4",children:[e("div",{className:"gap-12 grid grid-cols-[240px_280px]",children:o("div",{children:[e("span",{className:w,children:"\u521B\u5EFA\u65F6\u95F4\uFF1A"}),e("span",{className:O,children:n.createTime||"-"})]})}),o("div",{className:"ml-auto",children:[e("span",{className:w,children:"\u5907\u6CE8\uFF1A"}),e("span",{className:O,children:(ue()?n.remark:n.entrepotRemark)||"\u6682\u65E0"}),e(C,{type:"text",size:"mini",onClick:()=>{x(v(f({},n),{logisticsOrderProductList:n.orderProductVOList}))},children:e(Me,{})})]})]})]},n.id)})})}),((he=r==null?void 0:r.list)==null?void 0:he.length)?e(ze,{className:"mt-4 flex justify-end",total:r==null?void 0:r.total,onChange:(n,k)=>{h.changePageSize(k),h.changeCurrent(n)}}):null,!((me=r==null?void 0:r.list)==null?void 0:me.length)&&!l?e(oe,{className:"py-28"}):null]}),e(I,{title:"\u6DFB\u52A0\u5546\u54C1",visible:$===Y.create,onCancel:()=>{j.resetFields(),B(null)},unmountOnExit:!0,confirmLoading:H.loading,onOk:async()=>{H.run(),j.resetFields()},children:e(Q,{span:24,form:j,initialValues:{orderId:c==null?void 0:c.id,quantity:1},formItemConfigList:[...Ke.filter(n=>!["trackingNo"].includes(n.schema.field)),{schema:{field:"orderId"},formItemProps:{hidden:!0}}]})}),e(I,{title:"\u67E5\u770B\u9762\u5355",visible:P,onCancel:()=>_(null),unmountOnExit:!0,onOk:async()=>{_(null)},children:"\u9762\u5355\u4FE1\u606F\uFF0C\u5F00\u53D1\u4E2D..."}),o(I,{style:{width:870},title:"\u7F16\u8F91\u8BA2\u5355",visible:$===Y.edit,onCancel:()=>B(null),confirmLoading:z.loading,unmountOnExit:!0,onOk:async()=>{z.run()},children:[e(Q,{span:24,form:X,initialValues:c,className:"mb-4",formItemConfigList:[{schema:{field:"sendWarehouse",label:"\u6253\u5305\u4ED3\u5E93",required:!0},formItemProps:{},control:e(De,{})},{schema:{field:"transportType",label:"\u8FD0\u8F93\u7C7B\u578B"},control:e(ke,{type:"radio",dictCode:"transport_type"})},{schema:{field:"remark",label:"\u5907\u6CE8"},control:"textarea",controlProps:{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\uFF0C\u6B64\u5907\u6CE8\u4ED3\u5E93\u53EF\u89C1"}}],onChange:(n,k)=>{x(f(f({},c),k))}}),e(Ae,{data:c==null?void 0:c.orderProductVOList,isEdit:!0,onChange:n=>{x(v(f({},c),{logisticsOrderProductList:n}))}}),e(C,{className:"mt-4",type:"outline",long:!0,icon:e(He,{}),onClick:()=>{B(Y.create)},children:"\u6DFB\u52A0\u5546\u54C1"})]})]})};var fa=ga,ja=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",labelClass:w,valueClass:O,default:fa});export{F as E,Ae as G,fa as O,ra as R,Pe as T,sa as a,E as b,ma as e,wa as h,ja as i,T as o,aa as u};
