var Q=Object.defineProperty,U=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var T=(s,t,a)=>t in s?Q(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,u=(s,t)=>{for(var a in t||(t={}))Y.call(t,a)&&T(s,a,t[a]);if(x)for(var a of x(t))Z.call(t,a)&&T(s,a,t[a]);return s},F=(s,t)=>U(s,X(t));import{r as p,aP as j,aj as r}from"./vendor.019c2987.js";import{r as w,e as y}from"./entrepot.e592173e.js";import{S as E}from"./index.335c814c.js";import{a as c}from"./index.923f5d6c.js";function ne(s){const{isPureList:t}=s,[a,S]=p.exports.useState(),[v,L]=p.exports.useState(E.edit),[h]=j(),[l]=j(),[n,k]=p.exports.useState(null),[i,g]=p.exports.useState(null),{data:A,loading:P,run:m}=r(async e=>{if(t)return[];l.resetFields(),g(null);const o=u({pageNum:1,pageSize:100,entrepotId:n==null?void 0:n.id},e);if(!o.entrepotId)return[];const R=await w.getList(o),{list:d}=R.data.data;if(d.length){const I=d.find(O=>O.id===(i==null?void 0:i.id))||d[0];g(I),l.setFieldsValue(I)}return d},{manual:!1,refreshDeps:[n],debounceWait:300}),{run:f,data:z,loading:D}=r(async()=>{const e=await y.getList({pageNum:1,pageSize:100,entrepotType:1}),{list:o}=e.data.data;if(o.length){const R=o.find(d=>d.id===(n==null?void 0:n.id))||o[0];k(R)}return o}),{run:H,loading:N}=r(async e=>{await c(()=>y.insert(u({},e))),h.resetFields(),S(null),f()},{manual:!0}),{run:b,loading:q}=r(async e=>{await c(()=>w.insert(u({entrepotId:n.id},e))),l.resetFields(),await m({entrepotId:n.id})},{manual:!0}),{run:M,loading:V}=r(async e=>{await c(()=>w.remove(e)),g(null),await m({entrepotId:n.id})},{manual:!0}),{run:W,loading:B}=r(async e=>{await c(()=>y.remove(e)),k(null),await f()},{manual:!0}),{run:C,loading:G}=r(async e=>{await c(()=>w.update(e)),await m({entrepotId:n.id})},{manual:!0}),{run:J,loading:K}=r(async e=>{await c(()=>y.update(F(u({},e),{storeType:e.storeType[0]}))),await f()},{manual:!0});return p.exports.useEffect(()=>{L(i?E.edit:E.create)},[i]),{showTypeEntrepot:a,setShowTypeEntrepot:S,formEntrepotRef:h,formRacksRef:l,activeEntrepot:n,setActiveEntrepot:k,racksList:A,rackLoading:P,getRacksList:m,createEntrepotHandler:H,createEntrepotLoading:N,getEntrepotList:f,entrepotList:z,entrepotLoading:D,showTypeRacks:v,setShowTypeRacks:L,activeRacks:i,setActiveRacks:g,createRacksLoading:q,createRacksHandler:b,removeRacks:M,removeRacksLoading:V,updateRacks:C,updateRacksLoading:G,updateEntrepot:J,updateEntrepotLoading:K,removeEntrepot:W,removeEntrepotLoading:B}}export{ne as useEntrepotInfo};
