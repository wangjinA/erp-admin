var O=Object.defineProperty,U=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var T=(s,e,a)=>e in s?O(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,u=(s,e)=>{for(var a in e||(e={}))Y.call(e,a)&&T(s,a,e[a]);if(I)for(var a of I(e))Z.call(e,a)&&T(s,a,e[a]);return s},F=(s,e)=>U(s,X(e));import{r as p,aQ as j,af as r}from"./vendor.7897a533.js";import{r as w,e as y}from"./entrepot.369b13c8.js";import{S as E}from"./index.70508b9f.js";import{a as c}from"./index.627cc3c6.js";import"./index.80f47301.js";function st(s){const{isPureList:e}=s,[a,S]=p.exports.useState(),[v,L]=p.exports.useState(E.edit),[h]=j(),[l]=j(),[n,k]=p.exports.useState(null),[i,g]=p.exports.useState(null),{data:A,loading:b,run:m}=r(async t=>{if(e)return[];l.resetFields(),g(null);const o=u({pageNum:1,pageSize:100,entrepotId:n==null?void 0:n.id},t);if(!o.entrepotId)return[];const R=await w.getList(o),{list:d}=R.data.data;if(d.length){const x=d.find(K=>K.id===(i==null?void 0:i.id))||d[0];g(x),l.setFieldsValue(x)}return d},{manual:!1,refreshDeps:[n],debounceWait:300}),{run:f,data:P,loading:z}=r(async()=>{const t=await y.getList({pageNum:1,pageSize:100,entrepotType:1}),{list:o}=t.data.data;if(o.length){const R=o.find(d=>d.id===(n==null?void 0:n.id))||o[0];k(R)}return o}),{run:D,loading:H}=r(async t=>{await c(()=>y.insert(u({},t))),h.resetFields(),S(null),f()},{manual:!0}),{run:N,loading:q}=r(async t=>{await c(()=>w.insert(u({entrepotId:n.id},t))),l.resetFields(),await m({entrepotId:n.id})},{manual:!0}),{run:M,loading:Q}=r(async t=>{await c(()=>w.remove(t)),g(null),await m({entrepotId:n.id})},{manual:!0}),{run:V,loading:W}=r(async t=>{await c(()=>y.remove(t)),k(null),await f()},{manual:!0}),{run:B,loading:C}=r(async t=>{await c(()=>w.update(t)),await m({entrepotId:n.id})},{manual:!0}),{run:G,loading:J}=r(async t=>{await c(()=>y.update(F(u({},t),{storeType:t.storeType[0]}))),await f()},{manual:!0});return p.exports.useEffect(()=>{L(i?E.edit:E.create)},[i]),{showTypeEntrepot:a,setShowTypeEntrepot:S,formEntrepotRef:h,formRacksRef:l,activeEntrepot:n,setActiveEntrepot:k,racksList:A,rackLoading:b,getRacksList:m,createEntrepotHandler:D,createEntrepotLoading:H,getEntrepotList:f,entrepotList:P,entrepotLoading:z,showTypeRacks:v,setShowTypeRacks:L,activeRacks:i,setActiveRacks:g,createRacksLoading:q,createRacksHandler:N,removeRacks:M,removeRacksLoading:Q,updateRacks:B,updateRacksLoading:C,updateEntrepot:G,updateEntrepotLoading:J,removeEntrepot:V,removeEntrepotLoading:W}}export{st as useEntrepotInfo};
