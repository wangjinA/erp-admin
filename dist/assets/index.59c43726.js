var v=Object.defineProperty,M=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var b=(t,r,u)=>r in t?v(t,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[r]=u,s=(t,r)=>{for(var u in r||(r={}))y.call(r,u)&&b(t,u,r[u]);if(o)for(var u of o(r))g.call(r,u)&&b(t,u,r[u]);return t},m=(t,r)=>M(t,B(r));var C=(t,r)=>{var u={};for(var e in t)y.call(t,e)&&r.indexOf(e)<0&&(u[e]=t[e]);if(t!=null&&o)for(var e of o(t))r.indexOf(e)<0&&g.call(t,e)&&(u[e]=t[e]);return u};import{l as d,aj as p,r as P,R as A,j as n,ak as S,S as q,N as R,t as w}from"./vendor.019c2987.js";import{m as N}from"./menu.419e6c15.js";import{e as k}from"./express.930f4cc0.js";import{b as c,s as z,a as F,t as j,f as I}from"./index.923f5d6c.js";import{S as _}from"./index.f880861f.js";import{c as O}from"./statusTag.766c2cba.js";const T=200;function x(t){const r=d.exports.groupBy(t,a=>a.parentId);function u(a){const i=r[a.menuId];return i&&(a.children=i.map(u)),a}return t.filter(a=>a.parentId==="0").map(u)}function V(){return p(()=>N.list({pageNum:1,pageSize:T}).then(t=>x(t.data.data.list)))}const l={list(t){return c.post("/api/menu/list",t)},create(t){return c.post("/api/menu/insert",t)},update(t){return c.post("/api/menu/update",t)},remove(t){return c.get(`/api/menu/remove/${t}`)}},h=[{label:"\u76EE\u5F55",value:"M"},{label:"\u83DC\u5355",value:"C"},{label:"\u6309\u94AE",value:"F"}];function $(t){const a=t,{menuType:r}=a,u=C(a,["menuType"]),e=p(async()=>(await l.list({pageNum:1,pageSize:T,menuType:r==="C"?"M":"C"})).data.data.list.map(f=>({label:f.menuName,value:f.menuId})),{refreshDeps:[r]});return n(R,s({placeholder:"\u8BF7\u9009\u62E9",options:e.data||[],loading:e.loading},u))}function E({menuType:t,size:r}){var u;return n(w,{size:r,color:O[h.findIndex(e=>e.value===t)],children:(u=h.find(e=>e.value===t))==null?void 0:u.label})}var D=()=>{const[t,r]=P.exports.useState(),u=A.useRef();return p(async e=>{await z({content:"\u786E\u5B9A\u53D6\u6D88\uFF1F",okButtonProps:{status:"warning"}}),r(e),await F(()=>k.cancelReject(e.id)),u.current.refreshSearchTable()},{manual:!0}),n("div",{className:"p-4 bg-white",children:n(_,{majorKey:"menuId",ref:u,formProps:{onChange(e){console.log(e)}},name:"\u83DC\u5355\u7BA1\u7406",getListRequest:e=>l.list(m(s({},e),{pageNum:1,pageSize:T})).then(a=>(a.data.data.list=x(a.data.data.list),a)),createRequest:l.create,updateRequest:l.update,removeRequest:l.remove,requestQueryTransform:e=>s(s(s({},d.exports.omit(e,["applyTime","rejectionTime"])),j(e.applyTime,"applyStartTime","applyEndTime")),j(e.rejectionTime,"rejectionStartTime","rejectionEndTime")),formItemConfigList:[{schema:{label:"\u540D\u79F0",field:"menuName",required:!0},isCreate:!0},{schema:{label:"\u83DC\u5355\u7C7B\u578B",field:"menuType"},isCreate:!0,control:"select",controlProps:{options:h},render(e){return n(E,{menuType:e})}},{schema:{label:"\u8DEF\u5F84",field:"menuPath"},isCreate:!0},{schema:{label:"\u6807\u8BC6",field:"menuPerms",required:!0},isCreate:!0},{schema:{label:"\u7236\u7EA7\u83DC\u5355",field:"parentId"},isCreate:!0,hideTable:!0,showItemHandle(e){return!(!(e==null?void 0:e.menuType)||(e==null?void 0:e.menuType)==="M")},formItemProps:{noStyle:!0},control:n(S.Item,{noStyle:!0,shouldUpdate:(e,a)=>e.menuType!==a.menuType,children:e=>n(S.Item,{rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],field:"parentId",label:e.menuType==="C"?"\u76EE\u5F55":"\u83DC\u5355",children:n($,{menuType:e.menuType})})})},{schema:{label:"\u521B\u5EFA\u65F6\u95F4",field:"createTime"},render(e){return I(e)}},{schema:{label:"\u4FEE\u6539\u65F6\u95F4",field:"updateTime"},render(e){return I(e)}},{schema:{label:"\u72B6\u6001",field:"menuStatus"},render(e,a){return n(q,{defaultChecked:e==="0",type:"line",checkedText:"\u542F\u7528",uncheckedText:"\u7981\u7528",onChange:i=>{F(()=>l.update(m(s({},d.exports.omit(a,"children")),{menuStatus:i?"0":"1"})))}})}}]})})},W=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",MenuTypeTag:E,default:D});export{E as M,W as i,V as u};
