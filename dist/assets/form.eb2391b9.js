import{r as m,a6 as Z,a7 as ee,b as L,j as b,a8 as H,a9 as G,m as re,aa as ne,ab as te,ac as ie,ad as ae,B as J,M as oe}from"./vendor.1997470e.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{a as ue,u as se}from"./index.380169de.js";import{l as ce,s as R}from"./index.module.ddb54cb0.js";import{a as le}from"./index.224556eb.js";var fe=function(e){return function(n,r){var t=m.exports.useRef(!1);e(function(){return function(){t.current=!1}},[]),e(function(){if(!t.current)t.current=!0;else return n()},r)}},w=function(){return w=Object.assign||function(n){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},w.apply(this,arguments)};function I(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]]);return r}function de(e,n,r,t){function o(a){return a instanceof r?a:new r(function(u){u(a)})}return new(r||(r=Promise))(function(a,u){function s(f){try{i(t.next(f))}catch(d){u(d)}}function l(f){try{i(t.throw(f))}catch(d){u(d)}}function i(f){f.done?a(f.value):o(f.value).then(s,l)}i((t=t.apply(e,n||[])).next())})}function ve(e,n){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},t,o,a,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(i){return function(f){return l([i,f])}}function l(i){if(t)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(r=0)),r;)try{if(t=1,o&&(a=i[0]&2?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[i[0]&2,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(i[0]===6||i[0]===2)){r=0;continue}if(i[0]===3&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(i[0]===6&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(e,r)}catch(f){i=[6,f],o=0}finally{t=a=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function h(e,n){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var t=r.call(e),o,a=[],u;try{for(;(n===void 0||n-- >0)&&!(o=t.next()).done;)a.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(r=t.return)&&r.call(t)}finally{if(u)throw u.error}}return a}function y(e,n,r){if(r||arguments.length===2)for(var t=0,o=n.length,a;t<o;t++)(a||!(t in n))&&(a||(a=Array.prototype.slice.call(n,0,t)),a[t]=n[t]);return e.concat(a||Array.prototype.slice.call(n))}var M=function(e){return typeof e=="function"},me=!1,F=me;function O(e){F&&(M(e)||console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e)));var n=m.exports.useRef(e);n.current=m.exports.useMemo(function(){return e},[e]);var r=m.exports.useRef();return r.current||(r.current=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n.current.apply(this,t)}),r.current}var _=fe(m.exports.useEffect),K=function(e,n){var r=n.manual,t=n.ready,o=t===void 0?!0:t,a=n.defaultParams,u=a===void 0?[]:a,s=n.refreshDeps,l=s===void 0?[]:s,i=n.refreshDepsAction,f=m.exports.useRef(!1);return f.current=!1,_(function(){!r&&o&&(f.current=!0,e.run.apply(e,y([],h(u),!1)))},[o]),_(function(){f.current||r||(f.current=!0,i?i():e.refresh())},y([],h(l),!1)),{onBefore:function(){if(!o)return{stopNow:!0}}}};K.onInit=function(e){var n=e.ready,r=n===void 0?!0:n,t=e.manual;return{loading:!t&&r}};var pe=K;function ge(e,n){if(e===n)return!0;for(var r=0;r<e.length;r++)if(!Object.is(e[r],n[r]))return!1;return!0}function Q(e,n){var r=m.exports.useRef({deps:n,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!ge(r.deps,n))&&(r.deps=n,r.obj=e(),r.initialized=!0),r.obj}function X(e){var n=m.exports.useRef(e);return n.current=e,n}var he=function(e){F&&(M(e)||console.error("useUnmount expected parameter is a function, got ".concat(typeof e)));var n=X(e);m.exports.useEffect(function(){return function(){n.current()}},[])},U=he,N=new Map,ye=function(e,n,r){var t=N.get(e);(t==null?void 0:t.timer)&&clearTimeout(t.timer);var o=void 0;n>-1&&(o=setTimeout(function(){N.delete(e)},n)),N.set(e,w(w({},r),{timer:o}))},be=function(e){return N.get(e)},$=new Map,we=function(e){return $.get(e)},xe=function(e,n){$.set(e,n),n.then(function(r){return $.delete(e),r}).catch(function(){$.delete(e)})},S={},Pe=function(e,n){S[e]&&S[e].forEach(function(r){return r(n)})},z=function(e,n){return S[e]||(S[e]=[]),S[e].push(n),function(){var t=S[e].indexOf(n);S[e].splice(t,1)}},Re=function(e,n){var r=n.cacheKey,t=n.cacheTime,o=t===void 0?5*60*1e3:t,a=n.staleTime,u=a===void 0?0:a,s=n.setCache,l=n.getCache,i=m.exports.useRef(),f=m.exports.useRef(),d=function(v,c){s?s(c):ye(v,o,c),Pe(v,c.data)},g=function(v,c){return c===void 0&&(c=[]),l?l(c):be(v)};return Q(function(){if(!!r){var v=g(r);v&&Object.hasOwnProperty.call(v,"data")&&(e.state.data=v.data,e.state.params=v.params,(u===-1||new Date().getTime()-v.time<=u)&&(e.state.loading=!1)),i.current=z(r,function(c){e.setState({data:c})})}},[]),U(function(){var v;(v=i.current)===null||v===void 0||v.call(i)}),r?{onBefore:function(v){var c=g(r,v);return!c||!Object.hasOwnProperty.call(c,"data")?{}:u===-1||new Date().getTime()-c.time<=u?{loading:!1,data:c==null?void 0:c.data,error:void 0,returnNow:!0}:{data:c==null?void 0:c.data,error:void 0}},onRequest:function(v,c){var p=we(r);return p&&p!==f.current?{servicePromise:p}:(p=v.apply(void 0,y([],h(c),!1)),f.current=p,xe(r,p),{servicePromise:p})},onSuccess:function(v,c){var p;r&&((p=i.current)===null||p===void 0||p.call(i),d(r,{data:v,params:c,time:new Date().getTime()}),i.current=z(r,function(T){e.setState({data:T})}))},onMutate:function(v){var c;r&&((c=i.current)===null||c===void 0||c.call(i),d(r,{data:v,params:e.state.params,time:new Date().getTime()}),i.current=z(r,function(p){e.setState({data:p})}))}}:{}},Se=Re,Oe=function(e,n){var r=n.debounceWait,t=n.debounceLeading,o=n.debounceTrailing,a=n.debounceMaxWait,u=m.exports.useRef(),s=m.exports.useMemo(function(){var l={};return t!==void 0&&(l.leading=t),o!==void 0&&(l.trailing=o),a!==void 0&&(l.maxWait=a),l},[t,o,a]);return m.exports.useEffect(function(){if(r){var l=e.runAsync.bind(e);return u.current=Z(function(i){i()},r,s),e.runAsync=function(){for(var i=[],f=0;f<arguments.length;f++)i[f]=arguments[f];return new Promise(function(d,g){var v;(v=u.current)===null||v===void 0||v.call(u,function(){l.apply(void 0,y([],h(i),!1)).then(d).catch(g)})})},function(){var i;(i=u.current)===null||i===void 0||i.cancel(),e.runAsync=l}}},[r,s]),r?{onCancel:function(){var l;(l=u.current)===null||l===void 0||l.cancel()}}:{}},Ce=Oe,Ee=function(e,n){var r=n.loadingDelay,t=n.ready,o=m.exports.useRef();if(!r)return{};var a=function(){o.current&&clearTimeout(o.current)};return{onBefore:function(){return a(),t!==!1&&(o.current=setTimeout(function(){e.setState({loading:!0})},r)),{loading:!1}},onFinally:function(){a()},onCancel:function(){a()}}},je=Ee,Te=!!(typeof window!="undefined"&&window.document&&window.document.createElement),D=Te;function k(){return D?document.visibilityState!=="hidden":!0}var E=[];function Ae(e){return E.push(e),function(){var r=E.indexOf(e);E.splice(r,1)}}if(D){var Le=function(){if(!!k())for(var e=0;e<E.length;e++){var n=E[e];n()}};window.addEventListener("visibilitychange",Le,!1)}var Me=function(e,n){var r=n.pollingInterval,t=n.pollingWhenHidden,o=t===void 0?!0:t,a=n.pollingErrorRetryCount,u=a===void 0?-1:a,s=m.exports.useRef(),l=m.exports.useRef(),i=m.exports.useRef(0),f=function(){var d;s.current&&clearTimeout(s.current),(d=l.current)===null||d===void 0||d.call(l)};return _(function(){r||f()},[r]),r?{onBefore:function(){f()},onError:function(){i.current+=1},onSuccess:function(){i.current=0},onFinally:function(){u===-1||u!==-1&&i.current<=u?s.current=setTimeout(function(){!o&&!k()?l.current=Ae(function(){e.refresh()}):e.refresh()},r):i.current=0},onCancel:function(){f()}}:{}},Fe=Me;function Ne(e,n){var r=!1;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];r||(r=!0,e.apply(void 0,y([],h(t),!1)),setTimeout(function(){r=!1},n))}}function $e(){return D&&typeof navigator.onLine!="undefined"?navigator.onLine:!0}var j=[];function De(e){return j.push(e),function(){var r=j.indexOf(e);r>-1&&j.splice(r,1)}}if(D){var Y=function(){if(!(!k()||!$e()))for(var e=0;e<j.length;e++){var n=j[e];n()}};window.addEventListener("visibilitychange",Y,!1),window.addEventListener("focus",Y,!1)}var Be=function(e,n){var r=n.refreshOnWindowFocus,t=n.focusTimespan,o=t===void 0?5e3:t,a=m.exports.useRef(),u=function(){var s;(s=a.current)===null||s===void 0||s.call(a)};return m.exports.useEffect(function(){if(r){var s=Ne(e.refresh.bind(e),o);a.current=De(function(){s()})}return function(){u()}},[r,o]),U(function(){u()}),{}},We=Be,He=function(e,n){var r=n.retryInterval,t=n.retryCount,o=m.exports.useRef(),a=m.exports.useRef(0),u=m.exports.useRef(!1);return t?{onBefore:function(){u.current||(a.current=0),u.current=!1,o.current&&clearTimeout(o.current)},onSuccess:function(){a.current=0},onError:function(){if(a.current+=1,t===-1||a.current<=t){var s=r!=null?r:Math.min(1e3*Math.pow(2,a.current),3e4);o.current=setTimeout(function(){u.current=!0,e.refresh()},s)}else a.current=0},onCancel:function(){a.current=0,o.current&&clearTimeout(o.current)}}:{}},_e=He,Ue=function(e,n){var r=n.throttleWait,t=n.throttleLeading,o=n.throttleTrailing,a=m.exports.useRef(),u={};return t!==void 0&&(u.leading=t),o!==void 0&&(u.trailing=o),m.exports.useEffect(function(){if(r){var s=e.runAsync.bind(e);return a.current=ee(function(l){l()},r,u),e.runAsync=function(){for(var l=[],i=0;i<arguments.length;i++)l[i]=arguments[i];return new Promise(function(f,d){var g;(g=a.current)===null||g===void 0||g.call(a,function(){s.apply(void 0,y([],h(l),!1)).then(f).catch(d)})})},function(){var l;e.runAsync=s,(l=a.current)===null||l===void 0||l.cancel()}}},[r,t,o]),r?{onCancel:function(){var s;(s=a.current)===null||s===void 0||s.cancel()}}:{}},ze=Ue,ke=function(e){F&&(M(e)||console.error('useMount: parameter `fn` expected to be a function, but got "'.concat(typeof e,'".'))),m.exports.useEffect(function(){e==null||e()},[])},Ve=ke,qe=function(){var e=h(m.exports.useState({}),2),n=e[1];return m.exports.useCallback(function(){return n({})},[])},Ge=qe,Je=function(){function e(n,r,t,o){o===void 0&&(o={}),this.serviceRef=n,this.options=r,this.subscribe=t,this.initState=o,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=w(w(w({},this.state),{loading:!r.manual}),o)}return e.prototype.setState=function(n){n===void 0&&(n={}),this.state=w(w({},this.state),n),this.subscribe()},e.prototype.runPluginHandler=function(n){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var o=this.pluginImpls.map(function(a){var u;return(u=a[n])===null||u===void 0?void 0:u.call.apply(u,y([a],h(r),!1))}).filter(Boolean);return Object.assign.apply(Object,y([{}],h(o),!1))},e.prototype.runAsync=function(){for(var n,r,t,o,a,u,s,l,i,f,d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];return de(this,void 0,void 0,function(){var v,c,p,T,B,V,W,A,x,P,q;return ve(this,function(C){switch(C.label){case 0:if(this.count+=1,v=this.count,c=this.runPluginHandler("onBefore",d),p=c.stopNow,T=p===void 0?!1:p,B=c.returnNow,V=B===void 0?!1:B,W=I(c,["stopNow","returnNow"]),T)return[2,new Promise(function(){})];if(this.setState(w({loading:!0,params:d},W)),V)return[2,Promise.resolve(W.data)];(r=(n=this.options).onBefore)===null||r===void 0||r.call(n,d),C.label=1;case 1:return C.trys.push([1,3,,4]),A=this.runPluginHandler("onRequest",this.serviceRef.current,d).servicePromise,A||(A=(q=this.serviceRef).current.apply(q,y([],h(d),!1))),[4,A];case 2:return x=C.sent(),v!==this.count?[2,new Promise(function(){})]:(this.setState({data:x,error:void 0,loading:!1}),(o=(t=this.options).onSuccess)===null||o===void 0||o.call(t,x,d),this.runPluginHandler("onSuccess",x,d),(u=(a=this.options).onFinally)===null||u===void 0||u.call(a,d,x,void 0),v===this.count&&this.runPluginHandler("onFinally",d,x,void 0),[2,x]);case 3:if(P=C.sent(),v!==this.count)return[2,new Promise(function(){})];throw this.setState({error:P,loading:!1}),(l=(s=this.options).onError)===null||l===void 0||l.call(s,P,d),this.runPluginHandler("onError",P,d),(f=(i=this.options).onFinally)===null||f===void 0||f.call(i,d,void 0,P),v===this.count&&this.runPluginHandler("onFinally",d,void 0,P),P;case 4:return[2]}})})},e.prototype.run=function(){for(var n=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.runAsync.apply(this,y([],h(r),!1)).catch(function(o){n.options.onError||console.error(o)})},e.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},e.prototype.refresh=function(){this.run.apply(this,y([],h(this.state.params||[]),!1))},e.prototype.refreshAsync=function(){return this.runAsync.apply(this,y([],h(this.state.params||[]),!1))},e.prototype.mutate=function(n){var r=M(n)?n(this.state.data):n;this.runPluginHandler("onMutate",r),this.setState({data:r})},e}(),Ie=Je;function Ke(e,n,r){n===void 0&&(n={}),r===void 0&&(r=[]);var t=n.manual,o=t===void 0?!1:t,a=I(n,["manual"]);F&&n.defaultParams&&!Array.isArray(n.defaultParams)&&console.warn("expected defaultParams is array, got ".concat(typeof n.defaultParams));var u=w({manual:o},a),s=X(e),l=Ge(),i=Q(function(){var f=r.map(function(d){var g;return(g=d==null?void 0:d.onInit)===null||g===void 0?void 0:g.call(d,u)}).filter(Boolean);return new Ie(s,u,l,Object.assign.apply(Object,y([{}],h(f),!1)))},[]);return i.options=u,i.pluginImpls=r.map(function(f){return f(i,u)}),Ve(function(){if(!o){var f=i.state.params||n.defaultParams||[];i.run.apply(i,y([],h(f),!1))}}),U(function(){i.cancel()}),{loading:i.state.loading,data:i.state.data,error:i.state.error,params:i.state.params||[],cancel:O(i.cancel.bind(i)),refresh:O(i.refresh.bind(i)),refreshAsync:O(i.refreshAsync.bind(i)),run:O(i.run.bind(i)),runAsync:O(i.runAsync.bind(i)),mutate:O(i.mutate.bind(i))}}function Qe(e,n,r){return Ke(e,n,y(y([],h(r||[]),!1),[Ce,je,Fe,We,ze,pe,Se,_e],!1))}const Xe="",Ye=le.create({baseURL:Xe,timeout:10*1e3}),Ze=e=>{const{userLoginAccount:n,userLoginPassword:r,captcha:t}=e;return Ye.post("/api/system/login",{captcha:t,userLoginAccount:n,userLoginPassword:r})};function cr(){const e=m.exports.useRef(),[n,r]=m.exports.useState(""),[t,o,a]=ue("loginParams"),u=se(ce),[s,l]=m.exports.useState(!!t),{run:i,loading:f,data:d}=Qe(async c=>{const p=await Ze(c);console.log(p),p.data.code===0||oe.error(p.data.msg||u["login.form.login.errMsg"]),g(c)},{});console.log(d);function g(c){s?o(JSON.stringify(c)):a(),localStorage.setItem("userStatus","login"),window.location.href="/"}function v(){e.current.validate().then(c=>{i(c)})}return m.exports.useEffect(()=>{const c=!!t;if(l(c),e.current&&c){const p=JSON.parse(t);e.current.setFieldsValue(p)}},[t]),L("div",{className:R["login-form-wrapper"],children:[b("div",{className:R["login-form-title"],children:u["login.form.title"]}),b("div",{className:R["login-form-sub-title"],children:u["login.form.title"]}),b("div",{className:R["login-form-error-msg"],children:n}),L(H,{className:R["login-form"],layout:"vertical",ref:e,initialValues:{userName:"admin",password:"admin"},children:[b(H.Item,{field:"userLoginAccount",rules:[{required:!0,message:u["login.form.userName.errMsg"]}],children:b(G,{prefix:b(re,{}),placeholder:u["login.form.userName.placeholder"],onPressEnter:v})}),b(H.Item,{field:"userLoginPassword",rules:[{required:!0,message:u["login.form.password.errMsg"]}],children:b(G.Password,{prefix:b(ne,{}),placeholder:u["login.form.password.placeholder"],onPressEnter:v})}),L(te,{size:16,direction:"vertical",children:[L("div",{className:R["login-form-password-actions"],children:[b(ie,{checked:s,onChange:l,children:u["login.form.rememberPassword"]}),b(ae,{children:u["login.form.forgetPassword"]})]}),b(J,{type:"primary",long:!0,onClick:v,loading:f,children:u["login.form.login"]}),b(J,{type:"text",long:!0,className:R["login-form-register-btn"],children:u["login.form.register"]})]})]})]})}export{cr as default};
